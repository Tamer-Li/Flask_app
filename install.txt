deb http://deb.debian.org/debian bookworm main contrib non-free non-free-firmware
deb http://security.debian.org/debian-security bookworm-security main contrib non-free non-free-firmware
deb http://deb.debian.org/debian bookworm-updates main contrib non-free non-free-firmware

# Используем официальный образ Python
FROM python:3.9-slim

# Устанавливаем Apache и mod_wsgi
RUN apt-get update && apt-get install -y \
    apache2 \
    libapache2-mod-wsgi-py3 \
    && apt-get clean

# Создаем директорию для приложения
RUN mkdir -p /var/www/flask_app

# Копируем файлы приложения
COPY . /var/www/flask_app
WORKDIR /var/www/flask_app

# Устанавливаем зависимости Python
RUN pip install --no-cache-dir -r requirements.txt

# Копируем конфигурацию Apache
COPY apache.conf /etc/apache2/sites-available/000-default.conf

# Включаем mod_wsgi и настраиваем Apache
RUN a2enmod wsgi && a2ensite 000-default.conf

# Открываем порт 80
EXPOSE 80

# Запускаем Apache
CMD ["apachectl", "-D", "FOREGROUND"]




<VirtualHost *:80>
    ServerName localhost

    WSGIDaemonProcess flaskapp python-path=/var/www/flask_app
    WSGIScriptAlias / /var/www/flask_app/wsgi.py

    <Directory /var/www/flask_app>
        WSGIProcessGroup flaskapp
        WSGIApplicationGroup %{GLOBAL}
        Require all granted
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>